<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Shred + Run + Abs Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
    }
    body {
      background: #050816;
      color: #f9fafb;
      padding: 12px;
    }
    .app {
      max-width: 480px;
      margin: 0 auto;
    }
    .header {
      margin-bottom: 10px;
    }
    .title {
      font-size: 20px;
      font-weight: 700;
    }
    .subtitle {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 2px;
    }

    /* Compact dropdown nav */
    .nav-row {
      margin: 10px 0 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .nav-label {
      font-size: 11px;
      color: #9ca3af;
    }
    .nav-select {
      width: 100%;
      border-radius: 999px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      font-size: 12px;
      padding: 6px 10px;
    }

    .card {
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      border-radius: 18px;
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid #111827;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.6);
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .card-title {
      font-size: 14px;
      font-weight: 600;
    }
    .date-input {
      background: #020617;
      border-radius: 999px;
      border: 1px solid #374151;
      padding: 4px 10px;
      font-size: 12px;
      color: #e5e7eb;
    }
    input[type="date"] {
      background: transparent;
      border: none;
      color: inherit;
      font-size: 12px;
      outline: none;
    }
    input[type="date"]::-webkit-calendar-picker-indicator {
      filter: invert(1);
    }
    .exercise-row {
      display: grid;
      grid-template-columns: 1.5fr 0.7fr 0.9fr 1.1fr auto;
      gap: 4px;
      align-items: center;
      margin-top: 6px;
    }
    .exercise-row input {
      width: 100%;
      border-radius: 999px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      font-size: 11px;
      padding: 4px 8px;
    }
    .exercise-row input::placeholder {
      color: #6b7280;
    }
    .pill-label {
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #9ca3af;
      margin-top: 2px;
    }
    .btn {
      border-radius: 999px;
      border: none;
      font-size: 12px;
      padding: 6px 10px;
      cursor: pointer;
    }
    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #ec4899);
      color: #f9fafb;
    }
    .btn-outline {
      background: transparent;
      border: 1px solid #4b5563;
      color: #e5e7eb;
    }
    .btn-small {
      font-size: 10px;
      padding: 3px 6px;
    }
    .card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
    }
    .summary-text {
      font-size: 10px;
      color: #9ca3af;
    }
    .footer {
      margin-top: 4px;
      text-align: center;
      font-size: 10px;
      color: #6b7280;
    }

    /* Weight tracker styles */
    .weight-section {
      margin-top: 4px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .weight-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: flex-end;
    }
    .weight-input-group {
      display: flex;
      flex-direction: column;
      gap: 2px;
      flex: 1 1 120px;
    }
    .weight-input-group label {
      font-size: 10px;
      color: #9ca3af;
    }
    .weight-input-group input {
      border-radius: 999px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      font-size: 11px;
      padding: 4px 8px;
    }
    .weight-list {
      font-size: 10px;
      color: #e5e7eb;
      border-radius: 12px;
      border: 1px solid #111827;
      background: rgba(15, 23, 42, 0.7);
      padding: 8px;
    }
    .weight-list-header,
    .weight-list-row {
      display: grid;
      grid-template-columns: 1.1fr 0.9fr 0.9fr;
      gap: 4px;
      align-items: center;
      margin-bottom: 2px;
    }
    .weight-list-header {
      font-weight: 600;
      color: #9ca3af;
      border-bottom: 1px solid #1f2937;
      padding-bottom: 3px;
      margin-bottom: 4px;
    }
    .weight-list-summary {
      margin-top: 4px;
      padding-top: 4px;
      border-top: 1px solid #1f2937;
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="title">Shred + Run + Abs Log</div>
      <div class="subtitle">Use the dropdown to switch days or go to your weekly weight log.</div>
    </div>

    <!-- Compact dropdown nav -->
    <div class="nav-row">
      <div class="nav-label">View</div>
      <select id="viewSelect" class="nav-select">
        <option value="Monday">Mon – Push + Abs</option>
        <option value="Tuesday">Tue – Pull + Abs</option>
        <option value="Wednesday">Wed – Run Club + Abs</option>
        <option value="Thursday">Thu – Legs + Abs</option>
        <option value="Friday">Fri – Sprints + Abs</option>
        <option value="Saturday">Sat – Active Recovery</option>
        <option value="Sunday">Sun – Rest</option>
        <option value="Weight">Weight Log</option>
      </select>
    </div>

    <!-- WORKOUT VIEW -->
    <div id="workoutContainer">
      <div class="card">
        <div class="card-header">
          <div class="card-title" id="currentTemplateTitle">Mon – Push + Abs</div>
          <div class="date-input">
            <input type="date" id="datePicker" />
          </div>
        </div>

        <div id="exercisesContainer">
          <!-- rows inserted by JS -->
        </div>

        <div class="card-footer">
          <button class="btn btn-outline btn-small" id="addExerciseBtn">+ Add exercise</button>
          <div>
            <button class="btn btn-outline btn-small" id="clearBtn">Clear day</button>
            <button class="btn btn-primary btn-small" id="saveBtn">Save</button>
          </div>
        </div>
      </div>

      <div class="card" id="summarySection">
        <div class="card-header">
          <div class="card-title">Today’s Summary</div>
        </div>
        <div class="summary-text" id="summaryText">
          No data yet. Log this day’s workout to see sets and exercises.
        </div>
      </div>
    </div>

    <!-- WEIGHT VIEW -->
    <div id="weightContainer" style="display:none;">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Weekly Weight Log</div>
        </div>
        <div class="weight-section">
          <div class="weight-row">
            <div class="weight-input-group">
              <label for="weightDate">Weigh-in date</label>
              <input type="date" id="weightDate" />
            </div>
            <div class="weight-input-group">
              <label for="weightValue">Body weight (lb)</label>
              <input type="number" id="weightValue" placeholder="182" step="0.1" />
            </div>
            <button class="btn btn-primary btn-small" id="saveWeightBtn">Save weight</button>
          </div>
          <div class="weight-list" id="weightList">
            No weigh-ins yet. Log once per week.
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      Tip: On iPhone, open this in Safari, then Share → “Add to Home Screen” to use it like an app.
    </div>
  </div>

  <script>
    // === WORKOUT DAY LOGIC ===

    const templateTitles = {
      Monday: "Mon – Push + Abs",
      Tuesday: "Tue – Pull + Abs",
      Wednesday: "Wed – Run Club + Abs",
      Thursday: "Thu – Legs + Abs",
      Friday: "Fri – Sprints + Abs",
      Saturday: "Sat – Active Recovery",
      Sunday: "Sun – Rest"
    };

    const defaultTemplates = {
      Monday: [
        { name: "Dumbbell Chest Press Flat", sets: "3", reps: "8–12", weight: "" },
        { name: "Dumbbell Incline Press", sets: "3", reps: "8–12", weight: "" },
        { name: "Dumbbell Lateral Raise", sets: "3", reps: "10–15", weight: "" },
        { name: "Machine Fly", sets: "3", reps: "10–15", weight: "" },
        { name: "Tricep Press Machine", sets: "3", reps: "10–12", weight: "" },
        { name: "Cable Triceps Pushdown", sets: "3", reps: "12–15", weight: "" },
        { name: "Incline Walk (Incline 10–12, 3.0–3.5 mph)", sets: "1", reps: "10–15 min", weight: "" },
        { name: "Hanging Leg Raises", sets: "3", reps: "15", weight: "" },
        { name: "Weighted Cable Crunch", sets: "3", reps: "15", weight: "" },
        { name: "Plank", sets: "3", reps: "30–45 sec", weight: "" }
      ],
      Tuesday: [
        { name: "Chest Supported Row", sets: "3", reps: "8–12", weight: "" },
        { name: "Cable Seated Row", sets: "3", reps: "10–15", weight: "" },
        { name: "Wide Grip Pulldown", sets: "3", reps: "10–15", weight: "" },
        { name: "Reverse Pec Deck", sets: "3", reps: "12–15", weight: "" },
        { name: "Spider Curl", sets: "3", reps: "10–12", weight: "" },
        { name: "Rope Hammer Curl", sets: "3", reps: "10–15", weight: "" },
        { name: "Jog or Incline Walk (Zone 2)", sets: "1", reps: "1–2 miles / easy", weight: "" },
        { name: "Ab Wheel Rollouts", sets: "3", reps: "10–12", weight: "" },
        { name: "Lying Leg Raises", sets: "3", reps: "15", weight: "" },
        { name: "Side Plank", sets: "3", reps: "30 sec each side", weight: "" }
      ],
      Wednesday: [
        { name: "Run Distance", sets: "1", reps: "3 miles", weight: "Steady pace" },
        { name: "Warm-up Jog", sets: "1", reps: "5 min", weight: "" },
        { name: "Cool Down Walk", sets: "1", reps: "5 min", weight: "" },
        { name: "Flutter Kicks", sets: "3", reps: "30 sec", weight: "" },
        { name: "Toe Touches", sets: "3", reps: "20", weight: "" },
        { name: "Plank", sets: "3", reps: "30 sec", weight: "" }
      ],
      Thursday: [
        { name: "Seated Leg Curl", sets: "3", reps: "8–12", weight: "" },
        { name: "Hack Squat", sets: "3", reps: "8–12", weight: "" },
        { name: "Single Leg Press", sets: "3", reps: "10–15", weight: "" },
        { name: "Lying Hamstring Curl", sets: "3", reps: "10–15", weight: "" },
        { name: "Leg Extensions", sets: "3", reps: "10–15", weight: "" },
        { name: "Incline Walk or Stepmill", sets: "1", reps: "10 min", weight: "" },
        { name: "Weighted Plank", sets: "3", reps: "30 sec", weight: "" },
        { name: "Deadbug or Bird Dog", sets: "3", reps: "10 each side", weight: "" },
        { name: "Cable Woodchoppers", sets: "3", reps: "15 each side", weight: "" }
      ],
      Friday: [
        { name: "Sprint Intervals (20s sprint / 60s walk)", sets: "8–10", reps: "20s / 60s", weight: "" },
        { name: "Warm-up Jog", sets: "1", reps: "5 min", weight: "" },
        { name: "Cool Down Walk", sets: "1", reps: "5 min", weight: "" },
        { name: "Decline Sit-Ups", sets: "3", reps: "20", weight: "" },
        { name: "Reverse Crunches", sets: "3", reps: "15", weight: "" },
        { name: "Ab Wheel Rollouts", sets: "3", reps: "10", weight: "" }
      ],
      Saturday: [
        { name: "Light Jog / Incline Walk / Mobility", sets: "1", reps: "20–30 min", weight: "Easy / recovery" },
        { name: "Optional Core Work", sets: "", reps: "", weight: "" }
      ],
      Sunday: [
        { name: "Rest Day", sets: "", reps: "", weight: "Hydration, stretching, reset" }
      ]
    };

    const viewSelect = document.getElementById("viewSelect");
    const workoutContainer = document.getElementById("workoutContainer");
    const weightContainer = document.getElementById("weightContainer");

    const datePicker = document.getElementById("datePicker");
    const exercisesContainer = document.getElementById("exercisesContainer");
    const currentTemplateTitle = document.getElementById("currentTemplateTitle");
    const addExerciseBtn = document.getElementById("addExerciseBtn");
    const saveBtn = document.getElementById("saveBtn");
    const clearBtn = document.getElementById("clearBtn");
    const summaryText = document.getElementById("summaryText");

    let currentTemplate = "Monday";

    function getToday() {
      const d = new Date();
      const year = d.getFullYear();
      const month = String(d.getMonth() + 1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      return `${year}-${month}-${day}`;
    }

    function setDefaultDate() {
      datePicker.value = getToday();
    }

    function makeRow(exercise, index) {
      const row = document.createElement("div");
      row.className = "exercise-row";

      row.innerHTML = `
        <div>
          <input type="text" placeholder="Exercise" value="${exercise.name || ""}" data-field="name" data-index="${index}" />
          <div class="pill-label">exercise</div>
        </div>
        <div>
          <input type="text" placeholder="Sets" value="${exercise.sets || ""}" data-field="sets" data-index="${index}" />
          <div class="pill-label">sets</div>
        </div>
        <div>
          <input type="text" placeholder="Reps / Time" value="${exercise.reps || ""}" data-field="reps" data-index="${index}" />
          <div class="pill-label">reps / time</div>
        </div>
        <div>
          <input type="text" placeholder="Weight / Notes" value="${exercise.weight || ""}" data-field="weight" data-index="${index}" />
          <div class="pill-label">lbs / notes</div>
        </div>
        <button class="btn btn-outline btn-small" data-remove="${index}">X</button>
      `;

      return row;
    }

    function renderExercises(exercises) {
      exercisesContainer.innerHTML = "";
      exercises.forEach((ex, i) => {
        exercisesContainer.appendChild(makeRow(ex, i));
      });
    }

    function storageKey() {
      return `workout_${datePicker.value}_${currentTemplate}`;
    }

    function loadFromStorage() {
      const key = storageKey();
      const saved = localStorage.getItem(key);
      if (!saved) {
        const defaults = defaultTemplates[currentTemplate] || [];
        renderExercises(defaults);
        updateSummary(defaults);
        return;
      }
      try {
        const data = JSON.parse(saved);
        renderExercises(data);
        updateSummary(data);
      } catch (e) {
        const defaults = defaultTemplates[currentTemplate] || [];
        renderExercises(defaults);
        updateSummary(defaults);
      }
    }

    function collectExercises() {
      const inputs = exercisesContainer.querySelectorAll("input[data-index]");
      const map = {};
      inputs.forEach(input => {
        const idx = input.getAttribute("data-index");
        const field = input.getAttribute("data-field");
        if (!map[idx]) map[idx] = { name: "", sets: "", reps: "", weight: "" };
        map[idx][field] = input.value;
      });
      return Object.values(map);
    }

    function saveToStorage() {
      const exercises = collectExercises();
      localStorage.setItem(storageKey(), JSON.stringify(exercises));
      updateSummary(exercises);
    }

    function updateSummary(exercises) {
      if (!exercises || exercises.length === 0 || !exercises.some(e => e.name || e.sets || e.reps || e.weight)) {
        summaryText.textContent = "No data yet. Log this day’s workout to see total sets and exercises.";
        return;
      }

      let totalSets = 0;
      exercises.forEach(e => {
        const s = parseInt(e.sets);
        if (!isNaN(s)) totalSets += s;
      });

      summaryText.textContent = `${templateTitles[currentTemplate]} • ${exercises.length} exercise(s) • Approx. ${totalSets || "0"} total sets for this day on ${datePicker.value}.`;
    }

    viewSelect.addEventListener("change", () => {
      const view = viewSelect.value;
      if (view === "Weight") {
        workoutContainer.style.display = "none";
        weightContainer.style.display = "block";
      } else {
        weightContainer.style.display = "none";
        workoutContainer.style.display = "block";
        currentTemplate = view;
        currentTemplateTitle.textContent = templateTitles[view];
        loadFromStorage();
      }
    });

    datePicker.addEventListener("change", () => {
      loadFromStorage();
    });

    addExerciseBtn.addEventListener("click", () => {
      const exercises = collectExercises();
      exercises.push({ name: "", sets: "", reps: "", weight: "" });
      renderExercises(exercises);
    });

    exercisesContainer.addEventListener("click", (e) => {
      const btn = e.target.closest("button[data-remove]");
      if (!btn) return;
      const index = parseInt(btn.getAttribute("data-remove"));
      const exercises = collectExercises().filter((_, i) => i !== index);
      renderExercises(exercises);
    });

    saveBtn.addEventListener("click", saveToStorage);

    clearBtn.addEventListener("click", () => {
      if (!confirm("Clear this day’s log for this template?")) return;
      localStorage.removeItem(storageKey());
      const defaults = defaultTemplates[currentTemplate] || [];
      renderExercises(defaults);
      updateSummary(defaults);
    });

    exercisesContainer.addEventListener("focusout", () => {
      saveToStorage();
    });

    // === WEIGHT TRACKER LOGIC ===
    const weightDate = document.getElementById("weightDate");
    const weightValue = document.getElementById("weightValue");
    const saveWeightBtn = document.getElementById("saveWeightBtn");
    const weightList = document.getElementById("weightList");

    function getWeightData() {
      const raw = localStorage.getItem("bodyweight_log");
      if (!raw) return [];
      try {
        const data = JSON.parse(raw);
        return Array.isArray(data) ? data : [];
      } catch (e) {
        return [];
      }
    }

    function saveWeightData(data) {
      localStorage.setItem("bodyweight_log", JSON.stringify(data));
    }

    function renderWeightList() {
      const data = getWeightData().slice().sort((a, b) => a.date.localeCompare(b.date));
      if (!data.length) {
        weightList.textContent = "No weigh-ins yet. Log once per week.";
        return;
      }

      let html = '<div class="weight-list-header"><span>Date</span><span>Weight (lb)</span><span>Change</span></div>';

      const first = data[0];
      data.forEach((entry, idx) => {
        let changeText = "—";
        if (idx > 0) {
          const diff = entry.weight - data[idx - 1].weight;
          const sign = diff > 0 ? "+" : "";
          changeText = `${sign}${diff.toFixed(1)}`;
        }
        html += `
          <div class="weight-list-row">
            <span>${entry.date}</span>
            <span>${entry.weight.toFixed(1)}</span>
            <span>${changeText}</span>
          </div>
        `;
      });

      const last = data[data.length - 1];
      const netDiff = last.weight - first.weight;
      const signNet = netDiff > 0 ? "+" : "";
      html += `<div class="weight-list-summary">Net change: ${signNet}${netDiff.toFixed(1)} lb from ${first.date} to ${last.date}.</div>`;

      weightList.innerHTML = html;
    }

    function initWeightSection() {
      weightDate.value = getToday();
      renderWeightList();
    }

    saveWeightBtn.addEventListener("click", () => {
      const date = weightDate.value || getToday();
      const val = parseFloat(weightValue.value);
      if (isNaN(val)) {
        alert("Enter a valid weight in pounds.");
        return;
      }
      const data = getWeightData();
      const idx = data.findIndex(e => e.date === date);
      if (idx >= 0) {
        data[idx].weight = val;
      } else {
        data.push({ date, weight: val });
      }
      saveWeightData(data);
      renderWeightList();
      weightValue.value = "";
    });

    // Init on load
    function init() {
      setDefaultDate();
      currentTemplateTitle.textContent = templateTitles[currentTemplate];
      loadFromStorage();
      initWeightSection();
    }

    init();
  </script>
</body>
</html>